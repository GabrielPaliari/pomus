-- MySQL Script generated by MySQL Workbench
-- Sat Jun 23 08:46:58 2018
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema pomus_local
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema pomus_local
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `pomus_local` DEFAULT CHARACTER SET utf8 ;
USE `pomus_local` ;

-- -----------------------------------------------------
-- Table `pomus_local`.`User`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `pomus_local`.`User` (
  `UserId` INT NOT NULL AUTO_INCREMENT,
  `UserName` VARCHAR(100) NOT NULL,
  `Latitude` FLOAT NOT NULL,
  `Longitude` FLOAT NOT NULL,
  `Address` VARCHAR(500) NULL,
  PRIMARY KEY (`UserId`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `pomus_local`.`Student`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `pomus_local`.`Student` (
  `UserId` INT NOT NULL,
  PRIMARY KEY (`UserId`),
  CONSTRAINT `FK_Student_User`
    FOREIGN KEY (`UserId`)
    REFERENCES `pomus_local`.`User` (`UserId`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `pomus_local`.`Professor`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `pomus_local`.`Professor` (
  `UserId` INT NOT NULL,
  `Rating` FLOAT NULL,
  `Price` DOUBLE(5,2) NOT NULL,
  PRIMARY KEY (`UserId`),
  CONSTRAINT `FK_Professor_User`
    FOREIGN KEY (`UserId`)
    REFERENCES `pomus_local`.`User` (`UserId`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `pomus_local`.`Subject`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `pomus_local`.`Subject` (
  `SubjectId` INT NOT NULL,
  `Name` VARCHAR(100) NULL,
  `Description` VARCHAR(400) NULL,
  PRIMARY KEY (`SubjectId`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `pomus_local`.`Topic`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `pomus_local`.`Topic` (
  `TopicId` INT NOT NULL,
  `Name` VARCHAR(100) NULL,
  `Description` VARCHAR(400) NULL,
  `TopicFatherId` INT NULL,
  `SubjectId` INT NULL,
  PRIMARY KEY (`TopicId`),
  INDEX `FK_Topic_TopicParent_idx` (`TopicFatherId` ASC),
  INDEX `FK_Topic_Subject_idx` (`SubjectId` ASC),
  CONSTRAINT `FK_Topic_TopicParent`
    FOREIGN KEY (`TopicFatherId`)
    REFERENCES `pomus_local`.`Topic` (`TopicId`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `FK_Topic_Subject`
    FOREIGN KEY (`SubjectId`)
    REFERENCES `pomus_local`.`Subject` (`SubjectId`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `pomus_local`.`TopicProfessor`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `pomus_local`.`TopicProfessor` (
  `TopicProfessorId` INT NOT NULL,
  `TopicId` INT NOT NULL,
  `ProfessorId` INT NOT NULL,
  PRIMARY KEY (`TopicProfessorId`),
  INDEX `FK_TopicProfessor_Professor_idx` (`ProfessorId` ASC),
  INDEX `FK_TopicProfessor_Topic_idx` (`TopicId` ASC),
  CONSTRAINT `FK_TopicProfessor_Professor`
    FOREIGN KEY (`ProfessorId`)
    REFERENCES `pomus_local`.`Professor` (`UserId`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `FK_TopicProfessor_Topic`
    FOREIGN KEY (`TopicId`)
    REFERENCES `pomus_local`.`Topic` (`TopicId`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `pomus_local`.`Match`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `pomus_local`.`Match` (
  `MatchId` INT NOT NULL,
  `StudentAccepted` INT NULL,
  `ProfessorAccepted` INT NULL,
  `TopicProfessorId` INT NOT NULL,
  `StudentId` INT NOT NULL,
  PRIMARY KEY (`MatchId`),
  INDEX `FK_TopicProfessorId_idx` (`TopicProfessorId` ASC),
  INDEX `FK_Match_Student_idx` (`StudentId` ASC),
  CONSTRAINT `FK_Match_TopicProfessor`
    FOREIGN KEY (`TopicProfessorId`)
    REFERENCES `pomus_local`.`TopicProfessor` (`TopicProfessorId`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `FK_Match_Student`
    FOREIGN KEY (`StudentId`)
    REFERENCES `pomus_local`.`Student` (`UserId`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `pomus_local`.`Event`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `pomus_local`.`Event` (
  `EventId` INT NOT NULL,
  `Rating` FLOAT NULL,
  `Comment` VARCHAR(100) NULL,
  `StudentLatitude` FLOAT NULL,
  `StudentLongitude` FLOAT NULL,
  `ProfessorLatitude` FLOAT NULL,
  `ProfessorLongitude` FLOAT NULL,
  `StartTime` DATETIME NULL,
  `EndTime` DATETIME NULL,
  `MatchId` INT NULL,
  PRIMARY KEY (`EventId`),
  INDEX `FK_Event_Match_idx` (`MatchId` ASC),
  CONSTRAINT `FK_Event_Match`
    FOREIGN KEY (`MatchId`)
    REFERENCES `pomus_local`.`Match` (`MatchId`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;

-- -----------------------------------------------------
-- Data for table `pomus_local`.`User`
-- -----------------------------------------------------
START TRANSACTION;
USE `pomus_local`;
INSERT INTO `pomus_local`.`User` (`UserId`, `UserName`, `Latitude`, `Longitude`, `Address`) VALUES (1, 'Gabriel', -23.546085, -46.757631, 'Rua Ernesto Zuanella 234');
INSERT INTO `pomus_local`.`User` (`UserId`, `UserName`, `Latitude`, `Longitude`, `Address`) VALUES (2, 'Diego', -23.557818, -46.732322, 'Poli Bienio');
INSERT INTO `pomus_local`.`User` (`UserId`, `UserName`, `Latitude`, `Longitude`, `Address`) VALUES (3, 'Jonathan', -23.551030, -46.721633, 'Shopping Villa Lobos');
INSERT INTO `pomus_local`.`User` (`UserId`, `UserName`, `Latitude`, `Longitude`, `Address`) VALUES (4, 'Eric', -23.5660791, -46.652984, 'Av. Paulista');
INSERT INTO `pomus_local`.`User` (`UserId`, `UserName`, `Latitude`, `Longitude`, `Address`) VALUES (5, 'Jorge', -23.5569532, -46.6611564, 'Rua Augusta');
INSERT INTO `pomus_local`.`User` (`UserId`, `UserName`, `Latitude`, `Longitude`, `Address`) VALUES (6, 'Dandan', -23.0809842, -47.2112041, 'Rua Pedro de Toledo');
INSERT INTO `pomus_local`.`User` (`UserId`, `UserName`, `Latitude`, `Longitude`, `Address`) VALUES (7, 'Vinicius', -23.555694, -46.6641232, 'Rua Vinicius de Moraes');

COMMIT;


-- -----------------------------------------------------
-- Data for table `pomus_local`.`Student`
-- -----------------------------------------------------
START TRANSACTION;
USE `pomus_local`;
INSERT INTO `pomus_local`.`Student` (`UserId`) VALUES (3);
INSERT INTO `pomus_local`.`Student` (`UserId`) VALUES (7);

COMMIT;


-- -----------------------------------------------------
-- Data for table `pomus_local`.`Professor`
-- -----------------------------------------------------
START TRANSACTION;
USE `pomus_local`;
INSERT INTO `pomus_local`.`Professor` (`UserId`, `Rating`, `Price`) VALUES (1, 4.5, 50);
INSERT INTO `pomus_local`.`Professor` (`UserId`, `Rating`, `Price`) VALUES (2, 4.8, 75);
INSERT INTO `pomus_local`.`Professor` (`UserId`, `Rating`, `Price`) VALUES (4, 4.9, 25);
INSERT INTO `pomus_local`.`Professor` (`UserId`, `Rating`, `Price`) VALUES (5, 5.0, 30);
INSERT INTO `pomus_local`.`Professor` (`UserId`, `Rating`, `Price`) VALUES (6, 4.3, 40);

COMMIT;


-- -----------------------------------------------------
-- Data for table `pomus_local`.`Subject`
-- -----------------------------------------------------
START TRANSACTION;
USE `pomus_local`;
INSERT INTO `pomus_local`.`Subject` (`SubjectId`, `Name`, `Description`) VALUES (1, 'Cálculo', 'Cálculo - Ensino Superior');
INSERT INTO `pomus_local`.`Subject` (`SubjectId`, `Name`, `Description`) VALUES (2, 'Álgebra Linear', 'Álgebra Linear - Ensino Superior');
INSERT INTO `pomus_local`.`Subject` (`SubjectId`, `Name`, `Description`) VALUES (3, 'Física', 'Física - Ensino Superior');

COMMIT;


-- -----------------------------------------------------
-- Data for table `pomus_local`.`Topic`
-- -----------------------------------------------------
START TRANSACTION;
USE `pomus_local`;
INSERT INTO `pomus_local`.`Topic` (`TopicId`, `Name`, `Description`, `TopicFatherId`, `SubjectId`) VALUES (1, 'Integral', 'Integrais Simples, Duplas e Triplas', NULL, 1);
INSERT INTO `pomus_local`.`Topic` (`TopicId`, `Name`, `Description`, `TopicFatherId`, `SubjectId`) VALUES (2, 'Derivada', 'Regras de Derivação', NULL, 1);
INSERT INTO `pomus_local`.`Topic` (`TopicId`, `Name`, `Description`, `TopicFatherId`, `SubjectId`) VALUES (3, 'Espaços Vetoriais', 'Operações com Vetores', NULL, 2);
INSERT INTO `pomus_local`.`Topic` (`TopicId`, `Name`, `Description`, `TopicFatherId`, `SubjectId`) VALUES (4, 'Eletromagnetismo', 'Leis de Maxwell', NULL, 3);

COMMIT;


-- -----------------------------------------------------
-- Data for table `pomus_local`.`TopicProfessor`
-- -----------------------------------------------------
START TRANSACTION;
USE `pomus_local`;
INSERT INTO `pomus_local`.`TopicProfessor` (`TopicProfessorId`, `TopicId`, `ProfessorId`) VALUES (1, 1, 1);
INSERT INTO `pomus_local`.`TopicProfessor` (`TopicProfessorId`, `TopicId`, `ProfessorId`) VALUES (2, 1, 2);
INSERT INTO `pomus_local`.`TopicProfessor` (`TopicProfessorId`, `TopicId`, `ProfessorId`) VALUES (3, 2, 1);
INSERT INTO `pomus_local`.`TopicProfessor` (`TopicProfessorId`, `TopicId`, `ProfessorId`) VALUES (4, 3, 4);
INSERT INTO `pomus_local`.`TopicProfessor` (`TopicProfessorId`, `TopicId`, `ProfessorId`) VALUES (5, 1, 5);
INSERT INTO `pomus_local`.`TopicProfessor` (`TopicProfessorId`, `TopicId`, `ProfessorId`) VALUES (6, 4, 5);
INSERT INTO `pomus_local`.`TopicProfessor` (`TopicProfessorId`, `TopicId`, `ProfessorId`) VALUES (7, 2, 4);
INSERT INTO `pomus_local`.`TopicProfessor` (`TopicProfessorId`, `TopicId`, `ProfessorId`) VALUES (8, 2, 6);

COMMIT;


-- -----------------------------------------------------
-- Data for table `pomus_local`.`Match`
-- -----------------------------------------------------
START TRANSACTION;
USE `pomus_local`;
INSERT INTO `pomus_local`.`Match` (`MatchId`, `StudentAccepted`, `ProfessorAccepted`, `TopicProfessorId`, `StudentId`) VALUES (1, 1, 1, 5, 3);

COMMIT;


-- -----------------------------------------------------
-- Data for table `pomus_local`.`Event`
-- -----------------------------------------------------
START TRANSACTION;
USE `pomus_local`;
INSERT INTO `pomus_local`.`Event` (`EventId`, `Rating`, `Comment`, `StudentLatitude`, `StudentLongitude`, `ProfessorLatitude`, `ProfessorLongitude`, `StartTime`, `EndTime`, `MatchId`) VALUES (1, NULL, NULL, NULL, NULL, NULL, NULL, '2018-12-31 12:00:00', '2018-12-31 13:00:00', 1);

COMMIT;

